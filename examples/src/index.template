<!DOCTYPE html>
<html lang="ru">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <link href="js/themes/dark-hive/jquery-ui.css" rel="stylesheet" />
    <link href="js/themes/dark-hive/theme.css" rel="stylesheet" />
    <link href="js/jquery-ui-fix.css" rel="stylesheet" />

    <script type="text/javascript" src="js/jquery-3.7.1.min.js"></script>

    <script type="text/javascript" src="js/jquery-ui.js"></script>
    <script type="text/javascript" src="js/jquery-ui-fix.js"></script>

    <script type="text/javascript" src="js/free-queue.wasm.js"></script>
    <script type="text/javascript" src="js/free-queue.js"></script>

    <title>wasmFreeQueue test html page</title>
    <style></style>
    <script type="text/javascript">

	jQuery(document).ready(function () {

		Module.onRuntimeInitialized = () => { 
/*
			const __bufferlength = 282240;
			const __channelcount = 2;

			const freeQueue = new FreeQueue(__bufferlength, __channelcount);
			freeQueue.printAvailableReadAndWrite();

			var data1 = [2];

			data1[0] = new Float64Array(2000);
			data1[1] = new Float64Array(2000);

			for ( let i = 0; i < 2000; i++ ) {
				data1[0][i] = i + 0.00005;
				data1[1][i] = -i - 0.00005;
			}

			let r = false;

			r = freeQueue.push( data1, 2000 );
			console.log( "push: " + r );
			
			freeQueue.printAvailableReadAndWrite();

			r = freeQueue.push( data1, 2000 );
			console.log( "push: " + r );

			freeQueue.printAvailableReadAndWrite();

			r = freeQueue.push( data1, 2000 );
			console.log( "push: " + r );

			freeQueue.printAvailableReadAndWrite();

			console.log( "push data: " + data1 );

			var data2 = [2];
			data2[0] = new Float64Array(2000);
			data2[1] = new Float64Array(2000);

			r = freeQueue.pull( data2, 2000 );
			console.log( "pull: " + r );

			// console.log( freeQueue.channelData[0] );
			// console.log( freeQueue.channelData[1] );
			// PrintQueueInfo();

			freeQueue.printAvailableReadAndWrite();

			var data3 = [2];

			data3[0] = new Float64Array(2000);
			data3[1] = new Float64Array(2000);

			r = freeQueue.pull( data3, 2000 );
			console.log( "pull: " + r );

			console.log( "pull data: " + data1 );

			r = freeQueue.pull( data3, 2000 );
			console.log( "pull: " + r );

			freeQueue.printAvailableReadAndWrite();

			r = freeQueue.pull( data3, 2000 );
			console.log( "pull: " + r );

			freeQueue.printAvailableReadAndWrite();

			r = freeQueue.pull( data3, 2000 );
			console.log( "pull: " + r );

			// console.log( freeQueue.channelData[0] );
			// console.log( freeQueue.channelData[1] );
			// PrintQueueInfo();

			freeQueue.printAvailableReadAndWrite();
*/
		};

		$('#startTest').click(function() {
			var PrintQueueInfo = Module.cwrap('PrintQueueInfo','number',[ 'number' ]);
			PrintQueueInfo( window["instance"] );
		});
		
	});
    </script>
</head>

<body>
	<button id="startTest">some test</button>
</body>

</html>
</html>